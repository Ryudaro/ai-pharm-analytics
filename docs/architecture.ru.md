# Архитектура системы

## Обзор

AI-Pharm Analytics — это локальная система прогнозирования спроса,
предназначенная для работы с данными о продажах лекарственных препаратов
в аптечных организациях без обязательного использования облачных сервисов.

Архитектура системы ориентирована на:
- воспроизводимость результатов прогнозирования,
- прозрачность логики прогнозных расчётов,
- практическое применение в реальных условиях работы аптек.

Система построена как набор логически разделённых компонентов, каждый из
которых отвечает за отдельный этап процесса прогнозирования.

---

## Основные компоненты

### 1. Слой данных

Слой данных отвечает за подготовку входной информации для моделей прогнозирования.

Основные функции слоя:
- загрузка данных о продажах из локальных источников (CSV, Excel),
- проверка структуры и согласованности данных,
- базовая очистка и предобработка временных рядов,
- приведение данных к формату, пригодному для обучения моделей.

Слой данных работает со структурированными табличными временными рядами
и не зависит от конкретных моделей прогнозирования.

---

### 2. Слой моделирования

Слой моделирования содержит реализованные модели прогнозирования и
соответствующие обёртки над ними.

Основные функции слоя:
- обучение моделей на исторических данных,
- построение прогнозов на заданный горизонт,
- управление параметрами и конфигурациями моделей,
- предоставление единого интерфейса для различных подходов к моделированию.

Поддерживаемые подходы включают:
- классические модели временных рядов (например, ARIMA / SARIMA),
- методы машинного обучения (например, XGBoost).

Каждая модель изолирована и может быть расширена или заменена без
изменения других компонентов системы.

---

### 3. Слой оценки

Слой оценки предназначен для анализа качества прогнозов.

Основные функции слоя:
- расчёт метрик ошибки прогнозирования,
- сравнение результатов различных моделей,
- формирование интерпретируемых показателей качества.

Оценка основана на метриках, релевантных для аптечной практики, таких как
MAE, RMSE и MAPE, что позволяет интерпретировать точность прогнозов в
практически значимых величинах.

---

### 4. Процесс прогнозирования (управление пайплайном)

Данный компонент управляет процессом прогнозирования как единой
последовательностью шагов.

На практике он:
- задаёт порядок выполнения всех этапов (данные → модели → прогноз → оценка),
- фиксирует параметры и настройки запуска,
- обеспечивает воспроизводимость результатов,
- служит единой точкой запуска прогнозных расчётов и экспериментов.

Один запуск пайплайна соответствует одному полному прогнозному сценарию,
включающему обучение моделей, построение прогнозов и оценку их качества.

Такой подход позволяет использовать систему как для исследовательских
задач, так и для регулярных расчётов в аптечных организациях.

---

## Последовательность выполнения

Типовой сценарий работы системы включает следующие этапы:

1. Загрузка и валидация данных о продажах  
2. Предобработка временных рядов  
3. Разделение данных на обучающую и тестовую выборки  
4. Обучение выбранных моделей прогнозирования  
5. Построение прогнозов на заданный горизонт  
6. Расчёт метрик точности прогнозирования  
7. Сохранение результатов и параметров запуска  

---

## Принципы проектирования

- локальное выполнение без обязательной облачной инфраструктуры;
- чёткое разделение ответственности между компонентами системы;
- воспроизводимость и прозрачность прогнозных расчётов;
- ориентация на практические задачи реальных аптечных организаций.

---

## Примечания

Архитектура системы предусматривает возможность дальнейшего расширения,
включая:
- добавление новых моделей прогнозирования,
- подключение альтернативных источников данных,
- интеграцию с учётными системами аптечных организаций.

При этом базовая логика прогнозирования и общая структура системы
предполагаются стабильными.
